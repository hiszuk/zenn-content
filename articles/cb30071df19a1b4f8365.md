---
title: "Docker Desktop3.0.0ã§ãƒ“ãƒ«ãƒ‰å‡ºæ¥ãªã„?!"
emoji: "ğŸ³"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["docker", "proxy"]
published: true
---
# ã“ã®ã‚ˆã†ãªç—‡çŠ¶ã§ãŠå›°ã‚Šã®æ–¹ã«

ãƒã‚·ãƒ³ã‚’æ–°èª¿ã—ã€ã›ã£ã‹ãã ã‹ã‚‰Docker desktopã‚‚æœ€æ–°ã®3.0.0ã‚’å°å…¥ã™ã‚‹ã‹!
ã¨ã„ã†ã“ã¨ã§ã€å°å…¥ã—ãŸã¯ã‚ˆã„ãŒã€ãªãœã‹ä½•ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚‚ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦å›°ã£ãŸ..
ã¨ã„ã†æ–¹å‘ã‘ã®è¨˜äº‹ã§ã™ã€‚

```:ã‚¨ãƒ©ãƒ¼å‡ºåŠ›å†…å®¹
C:\Users\hoge\getting-started>docker build -t docker101tutorial .
[+] Building 12.6s (8/8) FINISHED
 => [internal] load build definition from Dockerfile                      0.0s
 => => transferring dockerfile: 1.35kB                                    0.0s
 => [internal] load .dockerignore                                         0.0s
 => => transferring context: 34B                                          0.0s
 => ERROR [internal] load metadata for docker.io/library/nginx:alpine    12.5s
 => ERROR [internal] load metadata for docker.io/library/node:12-alpine  12.5s
 => ERROR [internal] load metadata for docker.io/library/python:alpine   12.5s
 => [auth] library/nginx:pull token for registry-1.docker.io              0.0s
 => [auth] library/node:pull token for registry-1.docker.io               0.0s
 => [auth] library/python:pull token for registry-1.docker.io             0.0s
------
 > [internal] load metadata for docker.io/library/nginx:alpine:
------
------
 > [internal] load metadata for docker.io/library/node:12-alpine:
------
------
 > [internal] load metadata for docker.io/library/python:alpine:
------
failed to solve with frontend dockerfile.v0: failed to create LLB definition: failed to authorize: rpc error: code = Unknown desc = failed to fetch oauth token: Get https://auth.docker.io/token?scope=repository%3Alibrary%2Fnginx%3Apull&service=registry.docker.io: dial tcp: lookup auth.docker.io: getaddrinfow: This is usually a temporary error during hostname resolution and means that the local server did not receive a response from an authoritative server.
```

# ç™ºç”Ÿã™ã‚‹ç’°å¢ƒ

- Docker Desktop: 3.0.0
- ç¤¾å†…LANã‹ã‚‰proxyçµŒç”±ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’PULLã—ã¦ã„ã‚‹
- Docker Engine ã® buildkit ã‚’ true ã«ã—ã¦ã„ã‚‹ã€€â†ã€€æ–°è¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆã€è‡ªå‹•ã§è¨­å®šã•ã‚Œã‚‹

![proxyè¨­å®š](https://storage.googleapis.com/zenn-user-upload/juq2yvu0didy0omgnssiryb00f19)
*proxyè¨­å®š*

![Engine](https://storage.googleapis.com/zenn-user-upload/284pkt0rjgrpky43uolcpad6jjul)
*Engineè¨­å®š*

# è§£æ¶ˆæ–¹æ³•

ä»¥ä¸‹ï¼’ã¤ã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

## 1. docker.io ã‚’ insecure-registries ã«è¿½åŠ 

Docker Engine è¨­å®šç”»é¢ã«ã¦insecure-registriesã«docker.ioã‚’è¨­å®šã—ã¾ã™ã€‚

```
{
  "registry-mirrors": [],
  "insecure-registries": ["docker.io"],
  "debug": false,
  "experimental": false,
  "features": {
    "buildkit": true
  }
}
```

## 2. buildkit ã‚’ false ã«è¨­å®š

Docker Engine è¨­å®šç”»é¢ã«ã¦buildkitã‚’falseã«è¨­å®šã—ã¾ã™ã€‚

```
{
  "registry-mirrors": [],
  "insecure-registries": [],
  "debug": false,
  "experimental": false,
  "features": {
    "buildkit": false
  }
}
```

# ã•ã„ã”ã«

ç¤¾å†…LANã§dockerä½¿ã†ã®ã¯çµæ§‹å¤§å¤‰ã§ã™ã€‚
è‡ªå®…ç’°å¢ƒã ã¨è‹¦ã‚‚ãªãbuildå‡ºæ¥ã¦ã„ãŸã‚‚ã®ãŒã€å…¨ãé€šã‚‰ãªã„ã¨ã‹ã€‚
ã„ã‚ã„ã‚æ‰‹ã‚’å°½ãã—ã¦ã¿ã‚‹ãŒæœ€çµ‚çš„ã«ã¯è«¦ã‚ã¦ã€ãƒ†ã‚¶ãƒªãƒ³ã‚°ã‚„è‡ªåˆ†ã®dockerhubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ä¸€æ™‚çš„ã«pushã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’pullã—ãŸã‚Šã—ã¾ã™ã€‚

ã“ã®è¨˜äº‹ãŒçš†ã•ã‚“ã®ãŠå½¹ã«ç«‹ã¦ã‚Œã°å¬‰ã—ã„ã§ã™ã€‚
ã¾ãŸã€ä»–ã«ã‚‚ã£ã¨ã‚ˆã„æ–¹æ³•ãŒã‚ã‚Œã°ã‚¢ãƒ‰ãƒã‚¤ã‚¹ãã ã•ã„ã€‚
